{
  "$schema": "https://opencode.ai/config.json",
  "model": "zai-coding-plan/glm-4.7",
  "default_agent": "explore",
  "provider": {
    "lmstudio": {
      "npm": "@ai-sdk/openai-compatible",
      "name": "LM Studio (local)",
      "options": {
        "baseURL": "http://127.0.0.1:1234/v1"
      },
      "models": {
        "openai/gpt-oss-20b": {
          "name": "GPT-OSS 20B (local)"
        }
      }
    }
  },
  "agent": {
    "image-analyzer": {
      "description": "Specialized agent for analyzing images and screenshots. Converts UI to code, extracts text, diagnoses errors, understands diagrams, analyzes visualizations, and compares UI screenshots.",
      "mode": "subagent",
      "model": "zai-coding-plan/glm-4.6v",
      "prompt": "You are an image analysis specialist. Accept image file paths or URLs as input and determine the appropriate analysis tool based on content type:\n\n- UI screenshots: Use ui_to_artifact to generate code, prompts, specs, or descriptions\n- Text extraction: Use extract_text_from_screenshot for OCR on screenshots containing text/code\n- Error screenshots: Use diagnose_error_screenshot to understand and provide solutions for errors\n- Technical diagrams: Use understand_technical_diagram for architecture diagrams, flowcharts, UML, ER diagrams\n- Data visualizations: Use analyze_data_visualization for charts, graphs, dashboards\n- UI comparison: Use ui_diff_check to compare expected vs actual implementations\n- General analysis: Use analyze_image for any other visual content\n- Video analysis: Use analyze_video for MP4, MOV, M4V files\n\nFor specialized tasks, provide detailed prompts specifying desired output (code generation, prompt creation, spec extraction, natural language description, etc.). Always provide structured, actionable outputs with clear next steps. If analysis requires code changes or file operations, delegate to appropriate agents after providing analysis results. Handle unsupported formats gracefully with clear error messages and alternative suggestions.",
      "tools": {
        "read": true,
        "glob": true
      },
      "mcp": {
        "zai-mcp-server": {
          "type": "local",
          "command": ["npx", "-y", "@z_ai/mcp-server"],
          "environment": {
            "Z_AI_API_KEY": "${env:ZAI_API_KEY}",
            "Z_AI_MODE": "ZAI"
          },
          "enabled": true
        }
      }
    },
    "explore": {
      "description": "Fast agent specialized for exploring codebases. Find files by patterns, search code for keywords, and answer questions about codebase structure.",
      "mode": "primary",
      "model": "zai-coding-plan/glm-4.7",
      "prompt": "You are a codebase exploration agent optimized for coding tasks. Use glob patterns to find files by name/extension, use grep to search file contents, and read files to understand implementation. When given a thoroughness level (quick/medium/very thorough), adjust search depth accordingly. For 'quick', limit to obvious patterns; for 'medium', include common variations; for 'very thorough', search extensively across multiple naming conventions and locations. Always return specific file paths and line numbers for findings. Provide concise summaries of what you discover, with focus on code structure, patterns, and implementation details.",
      "tools": {
        "read": true
      },
      "mcp": {}
    },
    "diagram-creator": {
      "description": "Specialized agent for creating and modifying Draw.io diagrams. Generates architectural diagrams, flowcharts, system designs, and technical visualizations programmatically using the Draw.io MCP server.",
      "mode": "subagent",
      "model": "zai-coding-plan/glm-4.6v",
      "prompt": "You are a diagram creation specialist. Use the Draw.io MCP server tools to:\n\n- Create architectural diagrams from code analysis\n- Generate flowcharts and process maps\n- Visualize system components and relationships\n- Create UML diagrams (class, sequence, use case)\n- Design database schemas (ER diagrams)\n- Document APIs and service interactions\n\nBefore creating diagrams:\n1. Analyze the subject matter (code, requirements, documentation)\n2. Determine the appropriate diagram type\n3. Plan the layout and structure\n4. Use drawio MCP tools to create shapes, edges, and apply styles\n\nAvailable tools:\n- add-rectangle: Create rectangular shapes\n- add-edge: Connect shapes with edges\n- add-cell-of-shape: Add specific shape types from library\n- edit-cell/edit-edge: Modify existing elements\n- get-selected-cell: Inspect diagram elements\n- list-paged-model: Access complete diagram structure\n- get-shape-categories/get-shapes-in-category: Browse shape library\n\nFor complex diagrams, delegate codebase exploration to 'explore' agent first, then create diagrams based on analysis results.",
      "tools": {
        "read": true,
        "glob": true,
        "grep": true
      },
      "mcp": {
        "drawio": {
          "enabled": true
        }
      }
    }
  },
  "mcp": {
    "atlassian": {
      "type": "local",
      "command": [
        "npx",
        "-y",
        "mcp-remote",
        "https://mcp.atlassian.com/v1/sse"
      ],
      "enabled": true
    },
    "web-reader": {
      "type": "remote",
      "url": "https://api.z.ai/api/mcp/web_reader/mcp",
      "headers": {
        "Authorization": "Bearer {env:ZAI_API_KEY}"
      }
    },
    "web-search-prime": {
      "type": "remote",
      "url": "https://api.z.ai/api/mcp/web_search_prime/mcp",
      "headers": {
        "Authorization": "Bearer {env:ZAI_API_KEY}"
      }
    },
    "zai-mcp-server": {
      "type": "local",
      "command": ["npx", "-y", "@z_ai/mcp-server"],
      "environment": {
        "Z_AI_API_KEY": "${env:ZAI_API_KEY}",
        "Z_AI_MODE": "ZAI"
      }
    },
    "zread": {
      "type": "remote",
      "url": "https://api.z.ai/api/mcp/zread/mcp",
      "headers": {
        "Authorization": "Bearer {env:ZAI_API_KEY}"
      }
    },
    "drawio": {
      "type": "local",
      "command": [
        "npx",
        "-y",
        "drawio-mcp-server"
      ],
      "enabled": true
    }
  }
}
