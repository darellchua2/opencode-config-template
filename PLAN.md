# Plan: Fix agents to use ~/.config/opencode/skills/SKILL_INDEX.json for skill discovery

## Overview
This issue fixes a bug where Build-With-Skills and Plan-With-Skills agents assume skills are in local folder instead of using SKILL_INDEX.json file generated by setup.sh at ~/.config/opencode/skills/SKILL_INDEX.json.

## Issue Reference
- Issue: #43
- URL: https://github.com/darellchua2/opencode-config-template/issues/43
- Labels: bug

## Files to Modify
1. `AGENTS.md` - Update agent documentation to reflect correct skills discovery mechanism
2. `config.json` - Review agent configuration for any hardcoded paths
3. Any agent prompt files that reference skills discovery process in config.json

## Approach
Detailed steps for implementation:

1. **Step 1: Document correct skills discovery mechanism in AGENTS.md**
   - Update to Build-With-Skills agent section to explicitly state it should read from SKILL_INDEX.json
   - Update to Plan-With-Skills agent section similarly
   - Add example commands showing how to verify SKILL_INDEX.json location
   - Include error handling instructions for when SKILL_INDEX.json doesn't exist

2. **Step 2: Verify config.json agent prompts**
   - Review the agent prompts in config.json
   - Check for any hardcoded assumptions about skills location
   - Update prompts to reference SKILL_INDEX.json explicitly
   - Ensure both Build-With-Skills and Plan-With-Skills agents have correct discovery logic

3. **Step 3: Add fallback documentation**
   - Document what should happen if SKILL_INDEX.json is missing
   - Fallback to glob discovery in the template repository context with a warning
   - Add troubleshooting section for agents not finding skills

4. **Step 4: Update skill discovery examples**
   - Provide clear examples of how agents should discover skills
   - Show the path resolution logic: ~/.config/opencode/skills/[skill-path]/SKILL.md
   - Include verification commands

5. **Step 5: Test changes**
   - Verify documentation is clear and accurate
   - Ensure no misleading references to local skills folder remain
   - Check that all references to SKILL_INDEX.json are correct

## Success Criteria
- [ ] AGENTS.md correctly documents SKILL_INDEX.json discovery for both agents
- [ ] No hardcoded assumptions about local skills folder in documentation
- [ ] Agent prompts in config.json reference SKILL_INDEX.json correctly
- [ ] Fallback behavior is documented for missing SKILL_INDEX.json
- [ ] All path references are accurate and consistent
- [ ] Documentation includes troubleshooting guidance

## Notes
- The setup.sh generates SKILL_INDEX.json at lines 977-1047
- The SKILLS_DIR is set to ~/.config/opencode/skills (line 61)
- Skills are deployed with the command: cp -r ${SCRIPT_DIR}/skills/* ${SKILLS_DIR}/ (line 933)
- Agents should always check ~/.config/opencode/skills/SKILL_INDEX.json first before falling back
- This is a documentation and configuration update - no code changes to the agents themselves (they're part of the OpenCode framework)
